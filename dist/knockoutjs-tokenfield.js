/*! knockoutjs-tokenfield - v1.0.3 - 29-07-2014 */
ko.tokenfield={},ko.bindingHandlers.tokenField={init:function(a,b,c){var d=b()||{};if(ko.tokenfield[a.id]={},ko.tokenfield[a.id].handlerEnabled=!0,ko.tokenfield[a.id].bindings={},ko.tokenfield[a.id].bindings.Remote=c().tokenFieldRemote,ko.tokenfield[a.id].bindings.Method=c().tokenFieldMethod,ko.tokenfield[a.id].bindings.Datatype=c().tokenFieldDatatype,ko.tokenfield[a.id].bindings.Query=c().tokenFieldQuery,ko.tokenfield[a.id].bindings.KeyIndex=c().tokenFieldKeyIndex,ko.tokenfield[a.id].bindings.KeyDisplay=c().tokenFieldKeyDisplay,ko.tokenfield[a.id].bindings.Delimiter=c().tokenFieldDelimiter,void 0===ko.tokenfield[a.id].bindings.Remote)throw"Tokenfield remote server required.";void 0===ko.tokenfield[a.id].bindings.Method&&(ko.tokenfield[a.id].bindings.Method="GET"),void 0===ko.tokenfield[a.id].bindings.Datatype&&(ko.tokenfield[a.id].bindings.Datatype="json"),void 0===ko.tokenfield[a.id].bindings.Query&&(ko.tokenfield[a.id].bindings.Query="q"),void 0===ko.tokenfield[a.id].bindings.KeyIndex&&(ko.tokenfield[a.id].bindings.KeyIndex="value"),void 0===ko.tokenfield[a.id].bindings.KeyDisplay&&(ko.tokenfield[a.id].bindings.KeyDisplay="label"),void 0===ko.tokenfield[a.id].bindings.Delimiter&&(ko.tokenfield[a.id].bindings.Delimiter=","),ko.utils.domNodeDisposal.addDisposeCallback(a,function(){$(a).tokenfield("destroy")}),ko.utils.registerEventHandler(a,"tokenfield:createdtoken",function(b){0===b.attrs[ko.tokenfield[a.id].bindings.KeyDisplay].indexOf("_")&&$(b.relatedTarget).addClass("tt-private"),ko.tokenfield[a.id].handlerEnabled===!0&&d.push(b.attrs)}),ko.utils.registerEventHandler(a,"tokenfield:removedtoken",function(a){var b,c=d.peek();ko.utils.arrayForEach(c,function(c){ko.unwrap(c.id)===a.attrs.id?b=c:ko.unwrap(c.label)===a.attrs.label&&ko.unwrap(c.value)===a.attrs.value&&(b=c)}),d.remove(b)}),$(a).tokenfield({delimiter:ko.tokenfield[a.id].bindings.Delimiter,allowEditing:!1,createTokensOnBlur:!0,typeahead:[null,{name:a.id,displayKey:ko.tokenfield[a.id].bindings.KeyDisplay,source:function(){var b;return function(c,d){b&&b.abort(),c=c.split(",").reverse()[0].trim(),req_data={},req_data[ko.tokenfield[a.id].bindings.Query]=c,b=$.ajax({url:ko.tokenfield[a.id].bindings.Remote,data:req_data,type:ko.tokenfield[a.id].bindings.Method,dataType:ko.tokenfield[a.id].bindings.Datatype,success:function(a){d(a)},error:function(){d([])}})}}()}]})},update:function(a,b){var c=b()||{},d=ko.unwrap(c.peek());ko.tokenfield[a.id].handlerEnabled=!1,$(a).tokenfield("setTokens",d),ko.tokenfield[a.id].handlerEnabled=!0}};